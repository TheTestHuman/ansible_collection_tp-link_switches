---
- name: Configure Link Aggregation (LAG)
  hosts: managed_switches
  gather_facts: no
  connection: local
  
  vars:
    switch_host: "{{ ansible_host }}"
    switch_user: "admin"
    switch_pass: "neinnein"
  
  tasks:
    - name: Create LAG 1 with ports 9 and 10 (LACP active)
      tp_link_lag_expect:
        host: "{{ switch_host }}"
        username: "{{ switch_user }}"
        password: "{{ switch_pass }}"
        lag_id: 1
        ports: [9, 10]
        lacp_mode: active
      register: lag_result
      
    - name: Show LAG result
      debug:
        msg: "{{ lag_result.msg }}"
